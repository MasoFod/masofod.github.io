<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>【来点技术】快递员问题</title>
    <url>/posts/5fe5bce9.html</url>
    <content><![CDATA[<h2 id="题目背景">题目背景</h2>
<p>快递员遇到了一些小问题，每天的派送过程既繁琐又费时。而原因，就是派送的目的地要求的派送时间不一样。</p>
<h2 id="题目描述">题目描述</h2>
<p>给出一张无向图，每个节点有开关的时间，要求从起点出发，在节点开门的情况下遍历所有节点，问在耗时最短的情况下最晚可以从什么时候出发。其中，关门的节点依然可以经过，只是不计入访问。每一天的时间一共有1440。在到达关门的时间的时候，这个节点就已经关门了，例如节点在100的时候关门，则在100的时候到达并不认为成功访问。固定1号点为起点,且1号点没有开关门时间。</p>
<h2 id="输入格式">输入格式</h2>
<p>共n+m行。<br>
第1行为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>，表示点数和边数。<br>
第2行至第n行中，每一行有两个整数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>t</mi><mi>n</mi><mi>o</mi></msubsup></mrow><annotation encoding="application/x-tex">t^o_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9114em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>t</mi><mi>n</mi><mi>c</mi></msubsup></mrow><annotation encoding="application/x-tex">t^c_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9114em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>表示这个节点的开门时间和关门时间，其中n为行数。<br>
第n+1行至第n+m行中，每一行为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{ab}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ab</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，表示边的起点、终点及经过边需要使用的时间。</p>
<h2 id="输出格式">输出格式</h2>
<p>输出仅一个整数，表示出发的时间。若无法完成，则输出-1。</p>
<h2 id="输入输出示例">输入输出示例</h2>
<h3 id="输入-1">输入 #1</h3>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">2 1
0 1440
1 2 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="输出-2">输出 #2</h3>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">1438<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="说明">说明</h2>
<p>对所有数据，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>n</mi><mo>⩽</mo><mn>10000</mn></mrow><annotation encoding="application/x-tex">1&lt;n\leqslant10000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;vertical-align:-0.1367em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10000</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>m</mi><mo>⩽</mo><mn>10000</mn></mrow><annotation encoding="application/x-tex">0&lt;m\leqslant10000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7733em;vertical-align:-0.1367em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10000</span></span></span></span>。（数据范围我瞎编的）</p>
<hr>
<p>然而本人才疏学浅，并不能解决这个问题。可能经过一段时间就会发现其实这就是个很简单的问题吧。<br>
如果说数据设定为一定有解，那应该有取巧的办法，但如果不一定有解，那我还真就只能想到暴力。<br>
另外，这个问题还可以变一下式，比如结束的时间最早。这样的话跑暴力应该也好点。</p>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>技术</tag>
        <tag>算法</tag>
      </tags>
  </entry>
  <entry>
    <title>【来点技术】Godot开发中获得的一些经验（长期更新）</title>
    <url>/posts/83c20e8a.html</url>
    <content><![CDATA[<p>本人使用Godot做过一些小游戏（或者不算游戏的小东西），虽然每个项目的开发时间不长，项目规模也不大，但我还是获得了不少经验。因此在这里记录下来，以便警醒自己。<br>
如果你有什么自己的经验，也可以写在评论区。</p>
<h2 id="效率类">效率类</h2>
<p>1、做一个新功能之前，先搜一下有没有现成的插件。即使是过期插件，也可以从中学到思路。</p>
<h2 id="技巧类">技巧类</h2>
<p>1、多用信号，避免繁琐的节点访问。</p>
<p>2、避免频繁切换场景（<code>change_scene_to_file()</code>方法），否则性能开销较大。考虑使用一个<code>Main</code>根节点来组织场景树。</p>
<p>3、在<code>_process()</code>（或其他频繁调用的方法）中避免高消耗的操作，例如加载素材。</p>
<p>4、尽量使用<code>@export</code>的方法加载复杂路径的节点，避免在脚本中直接写节点路径，这样在更改节点路径后不会出问题。</p>
<h2 id="出错类">出错类</h2>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>技术</tag>
        <tag>Godot</tag>
      </tags>
  </entry>
  <entry>
    <title>【来点技术】Godot中实现简单的单机联机通用的客户端</title>
    <url>/posts/1f9f5e5.html</url>
    <content><![CDATA[<p>本文主要作为学习笔记。<br>
以下内容主要根据<a href="https://docs.godotengine.org/zh-cn/4.x/tutorials/networking/high_level_multiplayer.html">Godot的相关文档</a>和我的理解与实践编写，可能并非最佳实践，也可能存在错误，但是应该基本能用。</p>
<div class="note info flat"><p>本文基于4.3版本。</p>
</div>
<h2 id="Godot中的网络通讯基础">Godot中的网络通讯基础</h2>
<p>Godot中提供了一些较底层的实现，但是因为我用不上，所以就不讲了。<br>
Godot提供的高级api是用的UDP，支持IPv6。</p>
<h3 id="网络初始化">网络初始化</h3>
<p>每个节点都有一个<code>multiplayer</code>属性，它是对场景树为其配置的<code>MultiplayerAPI</code>实例的引用。可以对节点单独设置<code>MultiplayerAPI</code>，同时覆盖所有子节点。因此，可以实现在一个Godot示例中运行多个服务端和客户端。</p>
<p>可以通过如下方法创建客户端和服务端。</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token comment"># 创建客户端</span>
<span class="token keyword">var</span> peer <span class="token operator">=</span> ENetMultiplayerPeer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
peer<span class="token punctuation">.</span><span class="token function">create_client</span><span class="token punctuation">(</span><span class="token constant">IP_ADDRESS</span><span class="token punctuation">,</span> <span class="token constant">PORT</span><span class="token punctuation">)</span>
multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> peer

<span class="token comment"># 创建服务端</span>
<span class="token keyword">var</span> peer <span class="token operator">=</span> ENetMultiplayerPeer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
peer<span class="token punctuation">.</span><span class="token function">create_server</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token constant">MAX_CLIENTS</span><span class="token punctuation">)</span>
multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> peer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过如下方法结束联网。</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript">multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<div class="note info flat"><p>导出Android需要勾选INTERNET权限，否则不能联网。</p>
</div>
<h3 id="管理连接">管理连接</h3>
<p>这里要用到的一个概念是对等体，可以直接理解为一个没有性质的物体。<br>
系统会给每个对等体都分配一个唯一ID（UID），服务端的ID永远为1，客户端的ID则会被分配给一个随机的正整数。</p>
<p>可以通过<code>MultiplayerAPI</code>信号来检测连接建立和断开：<br>
· <code>peer_connected(id: int)</code> 此信号在每个其他对等体上与新连接的对等体ID一起发出，并在新对等点上多次发出，其中一次与每个其他对等点ID一起发出。<br>
· <code>peer_disconnected（id:int）</code> 当一个对等体断开连接时，剩余的每个对等体都会发出此信号。<br>
以下信号仅在客户端上发送：<br>
· <code>connected_to_server()</code><br>
· <code>connection_failed()</code><br>
· <code>server_disconnected()</code><br>
通过<code>multiplayer.get_unique_id()</code>获取关联的UID。<br>
通过<code>multiplayer.is_server()</code>获取对等体是服务端还是客户端。</p>
<h3 id="远程过程调用（RPC）">远程过程调用（RPC）</h3>
<p>远程过程调用是指在其他对等体上调用的函数。在函数定义前加上<code>@rpc</code>则将该函数创建为RPC。<br>
若要调用 RPC，请在每个对等体中通过 Callable 的 rpc() 方法调用之，或使用 rpc_id() 在特定对等方中调用之。</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> multiplayer<span class="token punctuation">.</span><span class="token function">is_server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		print_once_per_client<span class="token punctuation">.</span><span class="token function">rpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

@rpc
<span class="token keyword">func</span> <span class="token function">print_once_per_client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"每个连接的客户端都会将我打印到控制台一次。"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>要实现RPC，要求发送方和接收方的节点有相同的<code>NodePath</code>，包括节点名称。同时要求<code>@rpc</code>同时存在于服务端和客户端的对应函数，且函数的声明和返回类型等要相同。若要对预期使用RPC的节点调用<code>add_child()</code>时，请将参数<code>force_readable_name</code>设置为<code>true</code>。</p>
<div class="note info flat"><p>在这个<a href="https://github.com/godotengine/godot/issues/57869#issuecomment-1034215138">issue</a>中有更多关于RPC错误的信息。<br>
<a href="https://docs.godotengine.org/zh-cn/4.x/tutorials/networking/high_level_multiplayer.html#remote-procedure-calls">文档</a>也有说明。</p>
</div>
<p><code>@rpc</code>可以有多个参数，在没有设置时，采用如下预设：</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript">@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"authority"</span><span class="token punctuation">,</span> <span class="token string">"call_remote"</span><span class="token punctuation">,</span> <span class="token string">"unreliable"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>其参数及可选值如下：<br>
<code>mode</code>：<br>
· <code>&quot;authority&quot;</code> ：只有多人游戏权限端（服务端）才能远程调用该函数。<br>
· <code>&quot;any_peer&quot;</code> ：也允许客户端进行远程调用该函数，用于传输用户输入。<br>
<code>sync</code>：<br>
· <code>&quot;call_remote&quot;</code> ：让该函数不会在本地对等体上调用。<br>
· <code>&quot;call_local”</code> ：让该函数也可以在本地对等体上调用，在服务端也是玩家时非常有用。<br>
<code>transfer_mode</code>：<br>
· <code>&quot;unreliable&quot;</code> ：数据包不被确认，可能丢失，并且可以按任意顺序到达接收方。<br>
· <code>&quot;unreliable_ordered&quot;</code> ：数据包按照发送的顺序接收，透过忽略迟达的数据包（如果已经收到在这些数据包之后发送的另一个数据包）来实现的。使用不当可能会导致丢包。<br>
· <code>&quot;reliable&quot;</code> ：发送重新传送尝试，直到数据包被确认为止，且这些数据包的顺序会被保留。具有明显的性能损失。<br>
<code>transfer_channel</code>是信道索引。<br>
前3个参数在注解中的顺序任意，但<code>transfer_channel</code>参数必须始终位于注解中的最后。</p>
<p>在RPC所调用的函数中，可用函数<code>multiplayer.get_remote_sender_id()</code>来获取RPC发送方对等体的UID。</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">func</span> <span class="token function">_on_some_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 连接到某些输入。</span>
	transfer_some_input<span class="token punctuation">.</span><span class="token function">rpc_id</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 只对服务端发送输入。</span>


<span class="token comment"># 当服务端也是一个玩家时，需要设置为call_local。</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"any_peer"</span><span class="token punctuation">,</span> <span class="token string">"call_local"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">transfer_some_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 获得发送发UID。</span>
	<span class="token keyword">var</span> sender_id <span class="token operator">=</span> multiplayer<span class="token punctuation">.</span><span class="token function">get_remote_sender_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="信道">信道</h3>
<p>可以设置多个信道以实现互不干扰的通信，尤其是在需要的可靠度不同的时候可以提高效率。<br>
索引为0的信道实际是3个不同的传输模式的3个信道。（但我不是很理解这句）</p>
<h3 id="官方示例">官方示例</h3>
<p>下面为一个示例大厅，可以处理对等体的加入和离开，通过信号来通知UI场景，并在所有客户端加载游戏场景后启动游戏。</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Node</span>

<span class="token comment"># Autoload named Lobby</span>

<span class="token comment"># These signals can be connected to by a UI lobby scene or the game scene.</span>
<span class="token keyword">signal</span> <span class="token function">player_connected</span><span class="token punctuation">(</span>peer_id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>
<span class="token keyword">signal</span> <span class="token function">player_disconnected</span><span class="token punctuation">(</span>peer_id<span class="token punctuation">)</span>
<span class="token keyword">signal</span> server_disconnected

<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> <span class="token number">7000</span>
<span class="token keyword">const</span> <span class="token constant">DEFAULT_SERVER_IP</span> <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span> <span class="token comment"># IPv4 localhost</span>
<span class="token keyword">const</span> <span class="token constant">MAX_CONNECTIONS</span> <span class="token operator">=</span> <span class="token number">20</span>

<span class="token comment"># This will contain player info for every player,</span>
<span class="token comment"># with the keys being each player's unique IDs.</span>
<span class="token keyword">var</span> players <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token comment"># This is the local player info. This should be modified locally</span>
<span class="token comment"># before the connection is made. It will be passed to every other peer.</span>
<span class="token comment"># For example, the value of "name" can be set to something the player</span>
<span class="token comment"># entered in a UI scene.</span>
<span class="token keyword">var</span> player_info <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Name"</span><span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> players_loaded <span class="token operator">=</span> <span class="token number">0</span>



<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>peer_connected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_player_connected<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>peer_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_player_disconnected<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>connected_to_server<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_connected_ok<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>connection_failed<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_connected_fail<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>server_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_server_disconnected<span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">join_game</span><span class="token punctuation">(</span>address <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> address<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		address <span class="token operator">=</span> <span class="token constant">DEFAULT_SERVER_IP</span>
	<span class="token keyword">var</span> peer <span class="token operator">=</span> ENetMultiplayerPeer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> error <span class="token operator">=</span> peer<span class="token punctuation">.</span><span class="token function">create_client</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> <span class="token constant">PORT</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> error<span class="token punctuation">:</span>
		<span class="token keyword">return</span> error
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> peer


<span class="token keyword">func</span> <span class="token function">create_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> peer <span class="token operator">=</span> ENetMultiplayerPeer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> error <span class="token operator">=</span> peer<span class="token punctuation">.</span><span class="token function">create_server</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token constant">MAX_CONNECTIONS</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> error<span class="token punctuation">:</span>
		<span class="token keyword">return</span> error
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> peer

	players<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> player_info
	player_connected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">remove_multiplayer_peer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>


<span class="token comment"># When the server decides to start the game from a UI scene,</span>
<span class="token comment"># do Lobby.load_game.rpc(filepath)</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"call_local"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">load_game</span><span class="token punctuation">(</span>game_scene_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span>game_scene_path<span class="token punctuation">)</span>


<span class="token comment"># Every peer will call this when they have loaded the game scene.</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"any_peer"</span><span class="token punctuation">,</span> <span class="token string">"call_local"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">player_loaded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> multiplayer<span class="token punctuation">.</span><span class="token function">is_server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		players_loaded <span class="token operator">+=</span> <span class="token number">1</span>
		<span class="token keyword">if</span> players_loaded <span class="token operator">==</span> players<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			$<span class="token operator">/</span>root<span class="token operator">/</span>Game<span class="token punctuation">.</span><span class="token function">start_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			players_loaded <span class="token operator">=</span> <span class="token number">0</span>


<span class="token comment"># When a peer connects, send them my player info.</span>
<span class="token comment"># This allows transfer of all desired data for each player, not only the unique ID.</span>
<span class="token keyword">func</span> <span class="token function">_on_player_connected</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">:</span>
	_register_player<span class="token punctuation">.</span><span class="token function">rpc_id</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>


@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"any_peer"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">_register_player</span><span class="token punctuation">(</span>new_player_info<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> new_player_id <span class="token operator">=</span> multiplayer<span class="token punctuation">.</span><span class="token function">get_remote_sender_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	players<span class="token punctuation">[</span>new_player_id<span class="token punctuation">]</span> <span class="token operator">=</span> new_player_info
	player_connected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>new_player_id<span class="token punctuation">,</span> new_player_info<span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_player_disconnected</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">:</span>
	players<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
	player_disconnected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_connected_ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> peer_id <span class="token operator">=</span> multiplayer<span class="token punctuation">.</span><span class="token function">get_unique_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	players<span class="token punctuation">[</span>peer_id<span class="token punctuation">]</span> <span class="token operator">=</span> player_info
	player_connected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>peer_id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_connected_fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>


<span class="token keyword">func</span> <span class="token function">_on_server_disconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>
	players<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	server_disconnected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>游戏场景的根节点应命名为 Game，在其所附加的脚本中：</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Node3D</span> <span class="token comment"># Or Node2D.</span>



<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># Preconfigure game.</span>

	Lobby<span class="token punctuation">.</span>player_loaded<span class="token punctuation">.</span><span class="token function">rpc_id</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># Tell the server that this peer has loaded.</span>


<span class="token comment"># Called only on the server.</span>
<span class="token keyword">func</span> <span class="token function">start_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># All peers are ready to receive RPCs in this scene.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="自动同步">自动同步</h2>
<p><code>MultiplayerSynchronizer</code>节点可以实现多端自动同步。<br>
添加节点后，下方选择<code>复制</code>-&gt;<code>添加同步属性</code>，然后选择要同步的节点和属性。<br>
例如可以将多个<code>Sprite2D</code>的<code>Transform</code>同步，这样就可以实现所有端上的<code>Sprite2D</code>的位置同步了。</p>
<h2 id="实现一个可以单机或联机的客户端">实现一个可以单机或联机的客户端</h2>
<p>实际上是用官方示例改的。我只是加入了一个让单机与联机能用相同逻辑的脚本以及我自己的注解。</p>
<h3 id="总体节点架构">总体节点架构</h3>
<p>主场景<br>
Control_Main<br>
|- LineEdit_InputName<br>
|- Button_Solo<br>
|- Button_HostMutiplayer<br>
|- Button_JoinMutiplayer</p>
<p>实际游戏<br>
Control_Game<br>
|- Button_GetScore<br>
|- Button_End<br>
|- Label_Players<br>
|-MultiplayerSynchronizer_MultiplayerSynchronizer</p>
<p>主持多人游戏<br>
Control_HostMutiplayer<br>
|- Label_Players<br>
|- Button_Start<br>
|- Button_End</p>
<p>加入多人游戏<br>
Control_JoinMutiplayer<br>
|- Label-Players<br>
|- LineEdit_InputIP<br>
|- Button_Start<br>
|- Button_End</p>
<h3 id="编写脚本">编写脚本</h3>
<p><code>server.gd</code>（需要自动加载）</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Node</span>

<span class="token comment"># 自定义信号，方便别的地方获取信息</span>
<span class="token keyword">signal</span> <span class="token function">player_connected</span><span class="token punctuation">(</span>peer_id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>
<span class="token keyword">signal</span> <span class="token function">player_disconnected</span><span class="token punctuation">(</span>peer_id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>
<span class="token keyword">signal</span> server_disconnected
<span class="token keyword">signal</span> player_getscore

<span class="token comment"># 默认服务端配置</span>
<span class="token keyword">var</span> <span class="token constant">PORT</span> <span class="token operator">=</span> <span class="token number">7000</span>
<span class="token keyword">var</span> <span class="token constant">DEFAULT_SERVER_IP</span> <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>
<span class="token keyword">const</span> <span class="token constant">MAX_CONNECTIONS</span> <span class="token operator">=</span> <span class="token number">20</span>

<span class="token comment"># 以UID为索引</span>
@<span class="token keyword">export</span> <span class="token keyword">var</span> players <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> player_info <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"MasoFod"</span><span class="token punctuation">,</span> <span class="token string">"score"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">&#125;</span> <span class="token comment"># 该端的玩家信息，需要在建立连接前进行更改</span>

<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>peer_connected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_player_connected<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>peer_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_player_disconnected<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>connected_to_server<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_connected_ok<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>connection_failed<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_connected_fail<span class="token punctuation">)</span>
	multiplayer<span class="token punctuation">.</span>server_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>_on_server_disconnected<span class="token punctuation">)</span>

<span class="token comment"># 连接到指定IP的服务端</span>
<span class="token keyword">func</span> <span class="token function">join_game</span><span class="token punctuation">(</span>address <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> address<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		address <span class="token operator">=</span> <span class="token constant">DEFAULT_SERVER_IP</span>
	<span class="token keyword">var</span> peer <span class="token operator">=</span> ENetMultiplayerPeer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> error <span class="token operator">=</span> peer<span class="token punctuation">.</span><span class="token function">create_client</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> <span class="token constant">PORT</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> error<span class="token punctuation">:</span>
		<span class="token keyword">return</span> error
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> peer

<span class="token comment"># 创建服务端</span>
<span class="token keyword">func</span> <span class="token function">create_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> peer <span class="token operator">=</span> ENetMultiplayerPeer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> error <span class="token operator">=</span> peer<span class="token punctuation">.</span><span class="token function">create_server</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token constant">MAX_CONNECTIONS</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> error<span class="token punctuation">:</span>
		<span class="token keyword">return</span> error
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> peer

	<span class="token comment"># 将默认玩家设置为服务端玩家</span>
	players<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> player_info
	player_connected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>

<span class="token comment"># 停止联网</span>
<span class="token keyword">func</span> <span class="token function">remove_multiplayer_peer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token comment"># 可执行Server.load_game.rpc(filepath)重启游戏，仅服务端可调用</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"call_local"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">load_game</span><span class="token punctuation">(</span>game_scene_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span>game_scene_path<span class="token punctuation">)</span>

<span class="token comment"># 客户端连接到服务端时，发送玩家信息</span>
<span class="token keyword">func</span> <span class="token function">_on_player_connected</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">:</span>
	_register_player<span class="token punctuation">.</span><span class="token function">rpc_id</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>

<span class="token comment"># 所有客户端注册玩家信息</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"any_peer"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">_register_player</span><span class="token punctuation">(</span>new_player_info<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> new_player_id <span class="token operator">=</span> multiplayer<span class="token punctuation">.</span><span class="token function">get_remote_sender_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	players<span class="token punctuation">[</span>new_player_id<span class="token punctuation">]</span> <span class="token operator">=</span> new_player_info
	player_connected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>new_player_id<span class="token punctuation">,</span> new_player_info<span class="token punctuation">)</span>

<span class="token comment"># 客户端断开连接后服务端处理</span>
<span class="token keyword">func</span> <span class="token function">_on_player_disconnected</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">:</span>
	players<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
	player_disconnected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>

<span class="token comment"># 客户端建立连接后，在本地注册自己</span>
<span class="token keyword">func</span> <span class="token function">_on_connected_ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> peer_id <span class="token operator">=</span> multiplayer<span class="token punctuation">.</span><span class="token function">get_unique_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	players<span class="token punctuation">[</span>peer_id<span class="token punctuation">]</span> <span class="token operator">=</span> player_info
	player_connected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>peer_id<span class="token punctuation">,</span> player_info<span class="token punctuation">)</span>

<span class="token comment"># 客户端连接失败后断网</span>
<span class="token keyword">func</span> <span class="token function">_on_connected_fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token comment"># 客户端断开连接客户端处理</span>
<span class="token keyword">func</span> <span class="token function">_on_server_disconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>
	players<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	player_info<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">0</span>
	server_disconnected<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://main.tscn"</span><span class="token punctuation">)</span>

<span class="token comment"># 当有玩家的分数变化</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"any_peer"</span><span class="token punctuation">,</span> <span class="token string">"call_local"</span><span class="token punctuation">,</span> <span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">_on_player_get_score</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">:</span>
	players<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>score <span class="token operator">+=</span> <span class="token number">1</span>
	player_getscore<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 所有端开始游戏</span>
@<span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">"authority"</span><span class="token punctuation">,</span><span class="token string">"call_local"</span><span class="token punctuation">,</span><span class="token string">"reliable"</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">start_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://game.tscn"</span><span class="token punctuation">)</span>

<span class="token comment"># 结束本地游戏</span>
<span class="token keyword">func</span> <span class="token function">end_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	multiplayer<span class="token punctuation">.</span>multiplayer_peer <span class="token operator">=</span> <span class="token keyword">null</span>
	players<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	player_info<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://main.tscn"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>main.gd</code>（main的脚本，需要连接信号）</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Control</span>

@<span class="token keyword">onready</span> <span class="token keyword">var</span> input_name<span class="token punctuation">:</span> <span class="token class-name">LineEdit</span> <span class="token operator">=</span> <span class="token variable">$InputName</span>

<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	input_name<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token function">str</span><span class="token punctuation">(</span>Server<span class="token punctuation">.</span>player_info<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">_on_solo_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>player_info<span class="token punctuation">.</span>name <span class="token operator">=</span> input_name<span class="token punctuation">.</span>text
	Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> Server<span class="token punctuation">.</span>player_info
	Server<span class="token punctuation">.</span><span class="token function">create_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://game.tscn"</span><span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_host_mutiplayer_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>player_info<span class="token punctuation">.</span>name <span class="token operator">=</span> input_name<span class="token punctuation">.</span>text
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://host_mutiplayer.tscn"</span><span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_join_mutiplayer_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>player_info<span class="token punctuation">.</span>name <span class="token operator">=</span> input_name<span class="token punctuation">.</span>text
	Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> Server<span class="token punctuation">.</span>player_info
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://join_mutiplayer.tscn"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>game.gd</code>（game的脚本，需要连接信号）</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Control</span>

@<span class="token keyword">onready</span> <span class="token keyword">var</span> players<span class="token punctuation">:</span> <span class="token class-name">Label</span> <span class="token operator">=</span> <span class="token variable">$Players</span>

<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>player_getscore<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>refresh_text<span class="token punctuation">)</span>
	Server<span class="token punctuation">.</span>player_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>refresh_text<span class="token punctuation">)</span>
	<span class="token keyword">for</span> p <span class="token keyword">in</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">:</span>
		players<span class="token punctuation">.</span>text <span class="token operator">+=</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token operator">%</span>Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'分\n'</span>


<span class="token keyword">func</span> <span class="token function">_on_end_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span><span class="token function">end_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_get_score_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	<span class="token comment"># 对当前玩家+1分</span>
	Server<span class="token punctuation">.</span>_on_player_get_score<span class="token punctuation">.</span><span class="token function">rpc</span><span class="token punctuation">(</span>Server<span class="token punctuation">.</span>multiplayer<span class="token punctuation">.</span><span class="token function">get_unique_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 刷新积分榜</span>
<span class="token keyword">func</span> <span class="token function">refresh_text</span><span class="token punctuation">(</span>_id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> _player_info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	players<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">""</span>
	<span class="token keyword">for</span> p <span class="token keyword">in</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">:</span>
		players<span class="token punctuation">.</span>text <span class="token operator">+=</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token operator">%</span>Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'分\n'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>host_mutiplayer.gd</code>（HostMutiplayer的脚本，需要连接信号）</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Control</span>

@<span class="token keyword">onready</span> <span class="token keyword">var</span> players<span class="token punctuation">:</span> <span class="token class-name">Label</span> <span class="token operator">=</span> <span class="token variable">$Players</span>

<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>player_connected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>update_players<span class="token punctuation">)</span>
	Server<span class="token punctuation">.</span>player_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>update_players<span class="token punctuation">)</span>
	Server<span class="token punctuation">.</span><span class="token function">create_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">update_players</span><span class="token punctuation">(</span>_id<span class="token punctuation">:</span><span class="token class-name">int</span><span class="token punctuation">,</span> _player_info<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	players<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"玩家有：\n"</span>
	<span class="token keyword">for</span> p <span class="token keyword">in</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">:</span>
		players<span class="token punctuation">.</span>text <span class="token operator">+=</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'\n'</span>

<span class="token keyword">func</span> <span class="token function">_on_start_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>start_game<span class="token punctuation">.</span><span class="token function">rpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">_on_end_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span><span class="token function">end_game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>join_mutiplayer.gd</code>（JoinMutiplayer的脚本，需要连接信号）</p>
<pre class="line-numbers language-gdscript" data-language="gdscript"><code class="language-gdscript"><span class="token keyword">extends</span> <span class="token class-name">Control</span>

@<span class="token keyword">onready</span> <span class="token keyword">var</span> start<span class="token punctuation">:</span> <span class="token class-name">Button</span> <span class="token operator">=</span> <span class="token variable">$Start</span>
@<span class="token keyword">onready</span> <span class="token keyword">var</span> players<span class="token punctuation">:</span> <span class="token class-name">Label</span> <span class="token operator">=</span> <span class="token variable">$Players</span>
@<span class="token keyword">onready</span> <span class="token keyword">var</span> input_ip<span class="token punctuation">:</span> <span class="token class-name">LineEdit</span> <span class="token operator">=</span> <span class="token variable">$InputIP</span>

<span class="token keyword">func</span> <span class="token function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span>player_connected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>update_players<span class="token punctuation">)</span>
	Server<span class="token punctuation">.</span>player_disconnected<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>update_players<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">update_players</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span><span class="token class-name">int</span><span class="token punctuation">,</span> player_info<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	players<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"玩家有：\n"</span>
	<span class="token keyword">for</span> p <span class="token keyword">in</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">:</span>
		players<span class="token punctuation">.</span>text <span class="token operator">+=</span> Server<span class="token punctuation">.</span>players<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'\n'</span>

<span class="token keyword">func</span> <span class="token function">_on_start_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> ip <span class="token operator">=</span> <span class="token function">str</span><span class="token punctuation">(</span>input_ip<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
	<span class="token keyword">var</span> error <span class="token operator">=</span> Server<span class="token punctuation">.</span><span class="token function">join_game</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
	<span class="token keyword">if</span> error<span class="token punctuation">:</span>
		players<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"找不到服务器"</span>
	<span class="token keyword">else</span><span class="token punctuation">:</span>
		start<span class="token punctuation">.</span><span class="token function">queue_free</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">func</span> <span class="token function">_on_end_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">void</span><span class="token punctuation">:</span>
	Server<span class="token punctuation">.</span><span class="token function">remove_multiplayer_peer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">get_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change_scene_to_file</span><span class="token punctuation">(</span><span class="token string">"res://main.tscn"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="小提示">小提示</h2>
<p>左上<code>调试</code>-&gt;<code>自定义运行实例...</code>可以设置运行的时候打开几个实例，方便测试网络。</p>
<h2 id="总结">总结</h2>
<p>这篇所讲到的内容基本上用处不大，只适合做点小游戏联机。如果想做大量联机，还是得做专用服务器。<br>
如果看完了这篇文章还有不懂的，推荐看看<a href="https://www.bilibili.com/video/BV1aH4y167Lv">这个视频</a>，虽然语速很快，但是全是干货，如果无法理解，可以再看看文档，两个结合过后就很好懂了。<br>
只不过看起来我还是用得很不好，执着于造轮子思维，总想着自己实现，没想到有现成的东西可以用。<br>
因此我的代码中肯定有很多不“优美”的地方，还望大家谅解。</p>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>技术</tag>
        <tag>Godot</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】S级怪兽《贝希摩斯》被误认成小猫</title>
    <url>/posts/f77ebf81.html</url>
    <content><![CDATA[<p>全名：S级怪兽《贝希摩斯》被误认成小猫，成为精灵女孩的骑士（宠物）一起生活</p>
<p>Bangumi评分（截至2025.04.10）：4.7/10</p>
<p>个人评分：6/10</p>
<p>从剧情上讲，确实没啥看头。但是每一集都有洗澡，等的就是这个。</p>
<p>顺便看看真扎。</p>
<p>总之是个很平凡但可以看看的番，至少很放松。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
        <tag>卖肉</tag>
      </tags>
  </entry>
  <entry>
    <title>【来点技术】蒙特卡洛树搜索与决策AI</title>
    <url>/posts/fe85f19.html</url>
    <content><![CDATA[<p>本文主要根据个人理解写成，若有出错请指正。<br>
这篇文章能够帮助你快速理解蒙特卡洛树搜索的基础知识，但具体原理并不会具体讲解。因为我也不是特别懂。</p>
<h2 id="蒙特卡洛树搜索（Monte-Carlo-Tree-Search，MCTS）">蒙特卡洛树搜索（Monte Carlo Tree Search，MCTS）</h2>
<h3 id="基本原理">基本原理</h3>
<p>各种蒙特卡洛的思想主要是对于状态空间极大的环境进行多次简单的模拟，以求获得一个接近现实的近似值。例如，求一个圆形的面积，可以用一个矩形将圆形框起来，然后在矩形中大量随机取点并计算是否在圆内，即可按照在圆内点数与总点数的比值获得圆面积与矩形面积的比值。<br>
而蒙特卡洛树搜索算法的核心就是，通过多次模拟策略的结果来统计获得一个接近于最佳的策略。结合形成的树上节点模拟中获得的被访问的次数和总价值可以判断出一个选择是否是较优的。因此，模拟的次数越多，最后的策略一般也越好。</p>
<h3 id="算法适用">算法适用</h3>
<p>蒙特卡洛树搜索主要适用于离散且能知道全部信息的决策，例如下棋这种一步一步地走向终点且过程中并没有无法模拟的问题。这也是我了解到MCTS的原因（虽然最后我想做的东西失败了）。</p>
<h3 id="主要流程">主要流程</h3>
<p>MCTS的每一个循环主要有4个步骤：选择、扩展、模拟和反向传播。</p>
<h4 id="选择">选择</h4>
<p>从根节点（即当前状态）出发，通过一种策略（UCB公式，或者叫UCT，我不是很能理解这俩的区别）一步一步选择，直到选择到叶节点。<br>
UCB公式如下：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>C</mi><mi>B</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>c</mi><msqrt><mrow><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">/</mi><mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">UCB(v_i,v)={Q(v_i)/N(v_i)}+c{\sqrt{ {\log(N(v))}/{N(v_i)} } }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.305em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">))</span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span style="top:-2.895em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em;"><span></span></span></span></span></span></span></span></span></span><br>
其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>指当前节点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>指某个子节点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span>为价值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>为访问次数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>是一个自定义常数，一般用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mn>2</mn></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1328em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span></span>，根据经验调整。由此可知，随着模拟次数（即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>增大，加号后面的部分被<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>主导，使得UCB值更倾向于让<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>小的节点被选择。<br>
在比较子节点的UCB值后，选择最高的那个，接着下一步选择，直到叶节点。</p>
<h4 id="扩展">扩展</h4>
<p>这是我采取的策略。<br>
在到达一个叶节点时，对其添加所有可选的行动对应的子节点。用下棋的话来说就是，添加所有走子的下一个棋盘状态。<br>
另一种策略是只扩展一个子节点，如果按这种策略，上面的选择步骤的终结就可以是访问到未完全扩展的节点。选择结束后，即对当前节点添加一个未添加的动作的子节点。</p>
<h4 id="模拟">模拟</h4>
<p>如果当前节点不是终结态（例如棋局结束），则从当前节点开始，随机进行动作直到终结条件（棋局结束或者到达限制时间），得出一个价值（例如赢了就是1分，输了就-1分）。</p>
<h4 id="反向传播">反向传播</h4>
<p>也叫回溯价值。主要是根据选择的路径和模拟的结果，将选择的所有节点访问数+1，价值加上最终价值。</p>
<h2 id="与神经网络的结合">与神经网络的结合</h2>
<p>如果真的每一次计算都模拟很多次构建一棵树，那对计算要求还是挺高的。<br>
一种思路是，用MCTS可以计算出估计的最佳策略和价值，用这个值来训练神经网络模型，让模型有决策和估值的能力。<br>
因为模型有了决策和估值的能力，因此也可以用于模拟部分来计算最终价值。</p>
<p>因为放弃了模拟，因此在选择部分也加入模型的影响：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mi>C</mi><mi>B</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>c</mi><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msqrt><mrow><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">/</mi><mrow><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">UCB(v_i,v)={Q(v_i)/N(v_i)}+cP(v,v_i){\sqrt{ {N(v)}/{(N(v_i)+1)} } }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.05017em;">CB</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.305em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span><span class="mord">/</span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span style="top:-2.895em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em;"><span></span></span></span></span></span></span></span></span></span><br>
其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(v_i,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>表示从状态<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>转移到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>的概率，通过神经网络得出。c是一个常数，用来控制探索强度。<br>
其实用模型来指导搜索就类似于一种剪枝。</p>
<hr>
<p>我本来想写一个五子棋AI，用DeepSeek写了过后，加上各家AI的修改，结果效果非常差，不知道是不是因为模拟次数太少了。<br>
写完这篇过后我要去重新写一遍了，感觉有些地方有问题。</p>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>技术</tag>
        <tag>算法</tag>
        <tag>人工智能</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】RPG不动产</title>
    <url>/posts/1427c487.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.01.15）：5.4/10</p>
<p>个人评分：7/10</p>
<p>既然是芳文社，那不得不品了。只不过一打开的第一感想就是，女主这眼睛是否有点不对，以及不符合年龄的某地方。</p>
<p>别的不说，我就是来看可爱的。画得可爱就有分。啊我悟了，原来前段时间发现看什么都没意思，是因为画风不对胃口。</p>
<p>果然看可爱的番就会心情变好。</p>
<p>太热血辣！！！！！！</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>百合</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】变态王子与不笑猫</title>
    <url>/posts/a10ab4dd.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.16）：6.8/10</p>
<p>个人评分：9/10</p>
<p>虽然是十年前的番，但是画风还是很好，女生都很可爱。每个人的个性都很鲜明，故事也是围绕每个人的性格推动。很多情节也很好笑，虽然经常笑着笑着就笑不出来了。</p>
<p>不得不说，男主性格是真的好啊，该坦率的时候特别坦率。整部番全都是围绕男主进行，而且节奏很好，没有拖沓。虽说是后宫番，但其实可以认为是讲男主和各个女孩一起发生的故事。要是仅仅冲着后宫来看的话并不能得到太多乐趣，但是如果看作一部恋爱喜剧，体会其中的感情变化，那还是相当有趣的。</p>
<p>总之是一部值得一看的番，对我来说各个方面都接近完美。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>后宫</tag>
        <tag>搞笑</tag>
        <tag>恋爱</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】我和班上最讨厌的女生结婚了</title>
    <url>/posts/b931de29.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.03.29）：5.5/10</p>
<p>个人评分：5/10</p>
<p>6。</p>
<p>老套，且逆天，你要是个后宫结局，我还敬你是条汉子。故事节奏也是稀奇古怪，我看不懂且大受震撼。</p>
<p>看看妹妹就够了，这番真没啥能看的。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>恋爱</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】不正经的魔术讲师与禁忌教典</title>
    <url>/posts/360164f0.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.11）：6.2/10</p>
<p>个人评分：8/10</p>
<p>画风好又不好，剧情有新意，没有什么硬伤，至少我很满意。不过还是有一些俗套的东西，看看也行。</p>
<p>然后，著名表情包也出自这部番。</p>
<p><img src="https://s2.loli.net/2024/12/11/6i7MjQ8VPeGO2EY.jpg" alt="某张表情包出处"></p>
<p>总之个人认为值得一看，就是感觉吊胃口的东西太多了，如果能出第二季一起看就好了。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>恋爱</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】冰剑的魔术师将要统一世界</title>
    <url>/posts/74bc9031.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.09）：3.9/10</p>
<p>个人评分：5/10</p>
<p>一句话，女主好看（不穷的时候），但是剧情太典了，龙傲天剧情，情节推动很一般，以至于我一直倍速而且需要时不时停下缓缓。</p>
<p>男主太牛了，值得大家学习。不过学了可能被抓进去。</p>
<p>总之看了之后会后悔为什么看了，但是对我来说还能忍。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
        <tag>恋爱</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】叹气的亡灵想隐退</title>
    <url>/posts/7f701857.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.24）：6.3/10</p>
<p>个人评分：7/10</p>
<p>故事节奏还行，画风稍微有点不合胃口，但是还是挺喜欢的，尤其是小蒂诺。</p>
<p>在这部番中，你将见到，每一集开始一两分钟弹幕就会说下周见，因为OP非常特立独行。而ED也很有特点，以至于有一天起来脑子里第一个声音就是ED的一段。</p>
<p>总之属于比较推荐的一部番，算是比较能让人笑的作品。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>搞笑</tag>
        <tag>战斗</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】我的可爱对黑岩目高不管用</title>
    <url>/posts/ed229165.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.04.10）：4.4/10</p>
<p>个人评分：7/10</p>
<p>剧情属于是很典的，卖肉属于是可有可无的，角色也画得一般。</p>
<p>但是声优倒是挺大牌。</p>
<p>说实话，作为一个桃子番，大概还算合格。男主人设没有瞎搞，女主也能看出变化，虽然开头的时候看起来有点脑子不太对。</p>
<p>总之可以看看，也属于是不用带脑子的。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>恋爱</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】噗妮露是可爱史莱姆</title>
    <url>/posts/a90a8a3d.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.27）：7.3/10</p>
<p>个人评分：9/10</p>
<p>总之就是非常可爱。<br>
不喜欢噗妮露的有难了。<br>
你也许会被里面人的画风劝退，但是，噗妮露的各种形态都很好看。<br>
本以为是子供向，结果是<s>成人动画</s>。<br>
<img src="https://s2.loli.net/2024/12/27/SghHbrtjVv75nJs.png" alt="表情包"></p>
<p>剧情也基本上是单元剧类型，但还是有个先后顺序的影响。里面每个人特点鲜明，不过男主是真废物。可能看着确实会对男主生气吧，不过想想这就是小孩子，倒也不是不能接受。<br>
<img src="https://s2.loli.net/2024/12/27/bkyD2KV7Xo6Amze.png" alt="另一张表情包"></p>
<p>总之属于是很推荐的一部番，至少给我带来了不少欢乐。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>搞笑</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】异世界舅舅</title>
    <url>/posts/2da51f56.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.01.02）：7.6/10</p>
<p>个人评分：9/10</p>
<p>很好看。无论制作还是剧情，都做得很好。有很多很好笑的地方，我看得很开心。</p>
<p>唯一的问题就是，这种一节一节的剧情描述方式可能不合一些人的胃口。至少看得我很急，就像里面的男主和女主。但这也是特点吧。</p>
<p>总之就是，快出第二季，很急。尤其是听了群友爆料后面的漫画剧情过后就更急了。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>后宫</tag>
        <tag>搞笑</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】星刻的龙骑士</title>
    <url>/posts/f20036ba.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.10）：5.3/10</p>
<p>个人评分：7/10</p>
<p>十年前的动漫了，画风还能接受，至少女主很可爱。</p>
<p>设定有新意，剧情有点公式化，但总体不错。</p>
<p>福利场景很多，但是有些提不起兴趣。</p>
<p>最难绷的是下图。</p>
<p><img src="https://s2.loli.net/2024/12/10/tKRLMOcmpTokvUY.jpg" alt="某张截图"></p>
<p>总之还是比较推荐，是一部合格的后宫番厕纸。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】最弱技能《果实大师》</title>
    <url>/posts/ba57e674.html</url>
    <content><![CDATA[<p>全名：最弱技能《果实大师》 ~关于能无限食用技能果实（吃了就会死）这件事~</p>
<p>Bangumi评分（截至2025.03.29）：3.9/10</p>
<p>个人评分：4/10</p>
<p>属于是看了个寂寞，后面男主直接下线，咋滴，群像戏？</p>
<p>女儿挺可爱，别的没了。</p>
<p>这个结尾看着也是留伏笔，能不能有点自知之明。没事，你出第二季我继续吃实好吧。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】战斗员派遣中</title>
    <url>/posts/96772038.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.14）：6.3/10</p>
<p>个人评分：8/10</p>
<p>作为一部搞笑番，搞笑部分还算可以，能让我时不时笑一下。主要角色画得还行。</p>
<p>剧情比较典，但看的过程中并不会反感。</p>
<p>总之还是值得一看，挺有意思的。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
        <tag>搞笑</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】我立于百万生命之上 及第二季</title>
    <url>/posts/83cee2d9.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.14）：5.9/10 6.1/10</p>
<p>个人评分：7/10</p>
<p>剧情一般，没有让人看不下去。但是感觉节奏还行，不会让人觉得无聊。而且并非主打龙傲天的，没那么无脑。</p>
<p>总之属于可以一看的类型，正好有两季，拿来放松一下还行。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】最强阴阳师的异世界转生记</title>
    <url>/posts/ed36ff09.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.01.09）：5.9/10</p>
<p>个人评分：7/10</p>
<p>作画挺好，某些地方做得很精致，剧情有点降智，但我就是来看后宫的，也还能接受，除了中间的一个情节。</p>
<p>男主作为一根木头，非常好地保持了人设，反正我是不知道女主这些人喜欢他啥了，可能大伙觉得被救了就得以身相许吧。可惜我是个没啥能力的废物。</p>
<p>看到第12集的时候，我整个人都傻了。虽然有所预料，但是男主的表现还是太吓人了点。可能确实也是转生之前的影响吧。</p>
<p>从厕纸角度讲是一部及格以上的番，比较推荐一看。不过也确实看个乐。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】柔光魔女股份有限公司</title>
    <url>/posts/676a762e.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.27）：6.0/10</p>
<p>个人评分：8/10</p>
<p>画风可爱，情节也是一种突出中心的编排。剧情推进有一种老派的感觉，但是看着很舒服。</p>
<p>故事设定也很新颖，魔法是一种程序，魔法少女是一种工作。故事基本上就是围绕这个设定展开的，而人物就是将这个设定进一步发散。</p>
<p>个人认为还是很有意思的，但是我相信如果你真看了，肯定吐槽不会少。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>战斗</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】独自一人的异世界攻略</title>
    <url>/posts/1c1a1f03.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.14）：4.5/10</p>
<p>个人评分：3/10</p>
<p>画风一般，演出极其尴尬，剧情也很无聊。</p>
<p>但我确实每周一集追完了。可能每周看一集就能忍了。</p>
<p>如果开倍速可以看看，反正不动脑。</p>
<p>估计bgm评分还会接着跌就是了。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】月光下的异世界之旅</title>
    <url>/posts/c0cfa037.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.01.08）：6.0/10</p>
<p>个人评分：5/10</p>
<p>符合时代的作画，以及我觉得很无聊的剧情。人物没什么特色，在剧情中也没表现什么人物特点。每一集看了过后的唯一感想就是寂寞。</p>
<p>不过我也只看了7集，先搁置了。感觉还是得找找别的类型的番。</p>
<p>但是话说回来，这番好歹还是个及格吧。没什么雷，没什么亮点。适合睡前助眠。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】胆大党</title>
    <url>/posts/718237c1.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.27）：7.6/10</p>
<p>个人评分：8/10</p>
<p>故事很有趣，节奏把握很好，属于是很吸引人一直看下去的类型。</p>
<p>角色塑造也比较成功，都很有特点。也没什么违背人设的情节。</p>
<p>似乎大家对这部番的评价也挺高的，看来我的审美并没有完全被厕纸污染。</p>
<p>总之属于是比较推荐一看的，除非你不喜欢这种带点热血的青春小故事。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>恋爱</tag>
        <tag>战斗</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】精灵幻想记 及第二季</title>
    <url>/posts/6f9d9faf.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.27）：5.6/10 5.3/10</p>
<p>个人评分：6/10</p>
<p>画风挺好看的，尤其是女角色。故事属于一种很慢节奏的叙事，尤其是第二季的最后几集，已经慢到无聊了。</p>
<p>但是你别说，你还真别说，女角色真的好看，尤其是小老师。<br>
你就说你喜不喜欢小老师吧。</p>
<p>实在不想对剧情有太多评论，毕竟，能做到让人感觉不到爽的爽番也挺厉害的。</p>
<p>总之可以一看，当消磨时间了。一口气全看完是在还是有点折磨。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】落第骑士英雄谭</title>
    <url>/posts/1a79cd1f.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2024.12.23）：6.5/10</p>
<p>个人评分：7/10</p>
<p>画风挺好的，虽然是快10年前的番了，但还是挺好看的。剧情稍显无聊，有一点典，能够很容易猜到。</p>
<p>非常意外，bgm上大家评分都挺高，还以为这种剧情典的评分不会高，可能还是画太好了。</p>
<p>适合打发时间看看。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>后宫</tag>
        <tag>恋爱</tag>
        <tag>战斗</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】这个医师超麻烦</title>
    <url>/posts/c09f02d9.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.01.04）：6.1/10</p>
<p>个人评分：8/10</p>
<p>一开始看可能觉得很高血压，但是看着看着就开始笑了。虽然到后期有些笑点显得很重复，但我还是会笑。</p>
<p>如果让我简单总结，那就是太搞了。所有内容都是服从于搞怪，从而产生笑点。但是男主也太菜了。</p>
<p>总之属于是比较推荐的作品。但是我这连着看搞笑番实在有点累了，得去找点无脑厕纸平衡一下。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>搞笑</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】萌萌侵略者</title>
    <url>/posts/64a2dcb9.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.03.04）：6.6/10</p>
<p>个人评分：6/10</p>
<p>虽然有时候看着很尬，但是画风我很喜欢。</p>
<p>从内容来讲，搞笑程度并不高，看似有点深度，其实并没有。</p>
<p>弹幕更是重量级，还好我三倍速看不清弹幕。</p>
<p>总之是一部适合快进看看的番，看之前记得存放脑子。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
        <tag>搞笑</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】迟早是最强的炼金术师</title>
    <url>/posts/19568314.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.03.29）：4.8/10</p>
<p>个人评分：5/10</p>
<p>从内容上来讲，基本上没啥能记住的内容；从画面上来讲，还算可以，就是后面明显全是ppt。</p>
<p>适合无脑看看，打发时间得了。</p>
<p>唯一的问题是，勇者能不能有点用，这看着和没有也没多大区别，还是说打算马上出第二季……</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>推荐一个看番软件</title>
    <url>/posts/567274b5.html</url>
    <content><![CDATA[<p>推荐一个我经常用的看番软件：Animeko（<a href="https://myani.org/">https://myani.org/</a>或<a href="https://github.com/open-ani/animeko/">https://github.com/open-ani/animeko/</a>）。<br>
这个软件集成了Bangumi，登录Bangumi账号后，再使用这个软件看番就会自动把进度同步。同时，这个软件一键点格子比在Bangumi上快多了。而且这个软件会读取弹弹Play的弹幕。最爽的是，这个软件支持长按倍速，再也不用担心看厕纸不能快进了。</p>
<p>此外，分享一下关于数据源的经验（当前版本4.0.1，不确定后续版本是否相同）。<br>
先讲一下思路。<br>
有很多在线看番网站的模板大差不差，因此可以在已经给出的数据源中找出与你想用的数据源相似的，然后依葫芦画瓢改一改就行。其实大部分都不用改。<br>
给出一个我搞好的例子。以下是次元城的数据源。（2024年12月15日更新：自带次元城数据源了）</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"mediaSources"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token property">"factoryId"</span><span class="token operator">:</span><span class="token string">"web-selector"</span><span class="token punctuation">,</span><span class="token property">"version"</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">"arguments"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"次元城"</span><span class="token punctuation">,</span><span class="token property">"description"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"iconUrl"</span><span class="token operator">:</span><span class="token string">"https://www.cyc-anime.net/upload/site/20240319-1/25e700991446a527804c82a744731b60.png"</span><span class="token punctuation">,</span><span class="token property">"searchConfig"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"searchUrl"</span><span class="token operator">:</span><span class="token string">"https://www.cyc-anime.net/search.html?wd=&#123;keyword&#125;"</span><span class="token punctuation">,</span><span class="token property">"searchUseOnlyFirstWord"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"searchRemoveSpecial"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"rawBaseUrl"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"subjectFormatId"</span><span class="token operator">:</span><span class="token string">"indexed"</span><span class="token punctuation">,</span><span class="token property">"selectorSubjectFormatA"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"selectLists"</span><span class="token operator">:</span><span class="token string">"body > div.box-width > div > div.row-9 > div > div > div.right.rel.flex-auto > div.thumb-content > div.thumb-txt.cor4.hide"</span><span class="token punctuation">,</span><span class="token property">"preferShorterName"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"selectorSubjectFormatIndexed"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"selectNames"</span><span class="token operator">:</span><span class="token string">"body > .box-width .search-box .thumb-content > .thumb-txt"</span><span class="token punctuation">,</span><span class="token property">"selectLinks"</span><span class="token operator">:</span><span class="token string">"body > .box-width .search-box .thumb-menu > a"</span><span class="token punctuation">,</span><span class="token property">"preferShorterName"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"selectorSubjectFormatJsonPathIndexed"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"selectLinks"</span><span class="token operator">:</span><span class="token string">"$[*]['url', 'link']"</span><span class="token punctuation">,</span><span class="token property">"selectNames"</span><span class="token operator">:</span><span class="token string">"$[*]['title','name']"</span><span class="token punctuation">,</span><span class="token property">"preferShorterName"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"channelFormatId"</span><span class="token operator">:</span><span class="token string">"index-grouped"</span><span class="token punctuation">,</span><span class="token property">"selectorChannelFormatFlattened"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"selectChannelNames"</span><span class="token operator">:</span><span class="token string">".anthology-tab > .swiper-wrapper a"</span><span class="token punctuation">,</span><span class="token property">"matchChannelName"</span><span class="token operator">:</span><span class="token string">"^(?&lt;ch>.+?)(\\d+)?$"</span><span class="token punctuation">,</span><span class="token property">"selectEpisodeLists"</span><span class="token operator">:</span><span class="token string">".anthology-list-box"</span><span class="token punctuation">,</span><span class="token property">"selectEpisodesFromList"</span><span class="token operator">:</span><span class="token string">"a"</span><span class="token punctuation">,</span><span class="token property">"selectEpisodeLinksFromList"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"matchEpisodeSortFromName"</span><span class="token operator">:</span><span class="token string">"第\\s*(?&lt;ep>.+)\\s*[话集]"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"selectorChannelFormatNoChannel"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"selectEpisodes"</span><span class="token operator">:</span><span class="token string">".anthology-list-play"</span><span class="token punctuation">,</span><span class="token property">"selectEpisodeLinks"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"matchEpisodeSortFromName"</span><span class="token operator">:</span><span class="token string">"第\\s*(?&lt;ep>.+)\\s*[话集]"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"filterByEpisodeSort"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"filterBySubjectName"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"selectMedia"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"distinguishSubjectName"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"distinguishChannelName"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"matchVideo"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"enableNestedUrl"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">"matchNestedUrl"</span><span class="token operator">:</span><span class="token string">"^.+(m3u8|vip|xigua\\.php).+\\?"</span><span class="token punctuation">,</span><span class="token property">"matchVideoUrl"</span><span class="token operator">:</span><span class="token string">"(^http(s)?:\\/\\/(?!.*http(s)?:\\/\\/).+((\\.mp4)|(\\.mkv)|(m3u8)).*(\\?.+)?)|(akamaized)|(bilivideo.com)"</span><span class="token punctuation">,</span><span class="token property">"cookies"</span><span class="token operator">:</span><span class="token string">"quality=1080"</span><span class="token punctuation">,</span><span class="token property">"addHeadersToVideo"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"referer"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"userAgent"</span><span class="token operator">:</span><span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>记得测试一下是否正常。如果不正常，可能是次元城挂了，也可能是你的网络犯病，也可能是换网址了。<br>
我建议使用<a href="https://www.cycity.pro/">https://www.cycity.pro/</a>这个地址发布页看看次元城的最新网址。这个网站还是很不错的，广告影响不大。</p>
<p>当然，仅仅使用自带的源一般就够了。新番可以用BT，老番就老老实实用在线源吧。<br>
以我这里的网络，稀饭动漫和漫次元是比较好的，清晰度高且无广告。</p>
<p>祝大家看番顺利。</p>
]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>小工具</tag>
      </tags>
  </entry>
  <entry>
    <title>检验你是不是欧皇</title>
    <url>/posts/1dd25bb5.html</url>
    <content><![CDATA[<p>这个工具会生成一个ETH私钥，然后生成公钥和地址。<br>
接着在<a href="https://ethplorer.io/wallet/#">Ethplorer</a>查询该地址有没有币。<br>
因此在使用这个程序之前，需要搞一个Ethplorer的api，好在这个网站是有很高的免费额度的，虽然内地不好上。<br>
这个程序的最大限制在于api的速度，如果是搞本地查询，那肯定飞快。<br>
不管咋说，这东西都没啥用，2的32次方个钱包地址，找到有钱的，还没听说过（可能是我孤陋寡闻）。<br>
如果你真的欧皇附体查到了，那理论上会出现在<code>result.txt</code>里面。<br>
下面是这个程序的代码，记得改一下api。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> eth_keys <span class="token keyword">import</span> keys
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
<span class="token keyword">import</span> shelve
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> collections <span class="token keyword">import</span> deque

api <span class="token operator">=</span> <span class="token string">"你的api"</span>

<span class="token comment"># 设置日志记录</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>filename<span class="token operator">=</span><span class="token string">"errorlog.log"</span><span class="token punctuation">,</span> level<span class="token operator">=</span>logging<span class="token punctuation">.</span>ERROR<span class="token punctuation">)</span>

<span class="token comment"># 计数器存储文件</span>
COUNTS_DB <span class="token operator">=</span> <span class="token string">"api_counts.db"</span>

<span class="token comment"># 定义时间窗口长度</span>
SECONDLY_TIME_FRAME <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 每秒</span>
HOURLY_TIME_FRAME <span class="token operator">=</span> <span class="token number">3600</span>  <span class="token comment"># 每小时</span>
DAILY_TIME_FRAME <span class="token operator">=</span> <span class="token number">86400</span>  <span class="token comment"># 每天</span>
WEEKLY_TIME_FRAME <span class="token operator">=</span> <span class="token number">604800</span>  <span class="token comment"># 每周</span>

<span class="token comment"># 定义请求限制</span>
LIMITS <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"second"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"hour"</span><span class="token punctuation">:</span> <span class="token number">17500</span><span class="token punctuation">,</span> <span class="token string">"day"</span><span class="token punctuation">:</span> <span class="token number">378000</span><span class="token punctuation">,</span> <span class="token string">"week"</span><span class="token punctuation">:</span> <span class="token number">2381400</span><span class="token punctuation">&#125;</span>


<span class="token keyword">def</span> <span class="token function">get_counts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> shelve<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>COUNTS_DB<span class="token punctuation">)</span> <span class="token keyword">as</span> db<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token string">"timestamps"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> db<span class="token punctuation">:</span>
            db<span class="token punctuation">[</span><span class="token string">"timestamps"</span><span class="token punctuation">]</span> <span class="token operator">=</span> deque<span class="token punctuation">(</span>maxlen<span class="token operator">=</span>SECONDLY_TIME_FRAME<span class="token punctuation">)</span>
        <span class="token keyword">return</span> db<span class="token punctuation">[</span><span class="token string">"timestamps"</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">update_counts</span><span class="token punctuation">(</span>timestamps<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> shelve<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>COUNTS_DB<span class="token punctuation">,</span> writeback<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> db<span class="token punctuation">:</span>
        db<span class="token punctuation">[</span><span class="token string">"timestamps"</span><span class="token punctuation">]</span> <span class="token operator">=</span> timestamps


<span class="token keyword">def</span> <span class="token function">reset_counts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> shelve<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>COUNTS_DB<span class="token punctuation">,</span> writeback<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token keyword">as</span> db<span class="token punctuation">:</span>
        db<span class="token punctuation">[</span><span class="token string">"timestamps"</span><span class="token punctuation">]</span> <span class="token operator">=</span> deque<span class="token punctuation">(</span>maxlen<span class="token operator">=</span>SECONDLY_TIME_FRAME<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">is_over_limit</span><span class="token punctuation">(</span>timestamps<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> time_frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
    current_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 移除时间窗口之外的记录</span>
    <span class="token keyword">while</span> timestamps <span class="token keyword">and</span> current_time <span class="token operator">-</span> timestamps<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">></span> time_frame<span class="token punctuation">:</span>
        timestamps<span class="token punctuation">.</span>popleft<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>timestamps<span class="token punctuation">)</span> <span class="token operator">>=</span> limit


<span class="token keyword">def</span> <span class="token function">generate_key_pair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 生成一个安全的随机私钥</span>
    private_key <span class="token operator">=</span> keys<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 获取私钥的十六进制表示</span>
    private_key_hex <span class="token operator">=</span> private_key<span class="token punctuation">.</span>to_hex<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 输出私钥</span>
    <span class="token comment"># print(f"Private Key: &#123;private_key_hex&#125;")</span>

    <span class="token comment"># 从私钥派生公钥</span>
    public_key <span class="token operator">=</span> private_key<span class="token punctuation">.</span>public_key

    <span class="token comment"># 获取公钥的压缩形式</span>
    public_key_compressed_hex <span class="token operator">=</span> public_key<span class="token punctuation">.</span>to_hex<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 输出公钥</span>
    <span class="token comment"># print(f"Public Key: &#123;public_key_compressed_hex&#125;")</span>

    <span class="token comment"># 生成以太坊地址</span>
    address <span class="token operator">=</span> public_key<span class="token punctuation">.</span>to_checksum_address<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 输出地址</span>
    <span class="token comment"># print(f"Ethereum Address: &#123;address&#125;")</span>

    <span class="token keyword">return</span> private_key_hex<span class="token punctuation">,</span> public_key_compressed_hex<span class="token punctuation">,</span> address


<span class="token keyword">def</span> <span class="token function">make_api_request</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> address<span class="token punctuation">:</span>
        private_key_hex<span class="token punctuation">,</span> public_key_compressed_hex<span class="token punctuation">,</span> address <span class="token operator">=</span> generate_key_pair<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 拼接请求</span>
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://api.ethplorer.io/getAddressInfo/"</span></span> <span class="token operator">+</span> address <span class="token operator">+</span> <span class="token string">"?apiKey="</span> <span class="token operator">+</span> api

    <span class="token comment"># 发送请求</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token comment"># 解析响应</span>
    data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 是否是空钱包</span>
    non_zero_balances <span class="token operator">=</span> <span class="token boolean">False</span>

    <span class="token comment"># 检测有没有ETH</span>
    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"ETH"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        non_zero_balances <span class="token operator">=</span> <span class="token boolean">True</span>

    <span class="token comment"># 检测别的代币</span>
    <span class="token keyword">if</span> <span class="token string">"tokens"</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        <span class="token keyword">for</span> token <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">"tokens"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> token<span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                non_zero_balances <span class="token operator">=</span> <span class="token boolean">True</span>
                <span class="token keyword">break</span>
    <span class="token comment"># BNB链查询</span>
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://api.binplorer.com/getAddressInfo/"</span></span> <span class="token operator">+</span> address <span class="token operator">+</span> <span class="token string">"?apiKey="</span> <span class="token operator">+</span> api

    <span class="token comment"># 发送请求</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token comment"># 解析响应</span>
    data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 检测BNB（返回为ETH）</span>
    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"ETH"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        non_zero_balances <span class="token operator">=</span> <span class="token boolean">True</span>

    <span class="token comment"># 检测别的代币</span>
    <span class="token keyword">if</span> <span class="token string">"tokens"</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        <span class="token keyword">for</span> token <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">"tokens"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> token<span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                non_zero_balances <span class="token operator">=</span> <span class="token boolean">True</span>
                <span class="token keyword">break</span>

    <span class="token keyword">return</span> non_zero_balances


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    private_key_hex<span class="token punctuation">,</span> public_key_compressed_hex<span class="token punctuation">,</span> address <span class="token operator">=</span> generate_key_pair<span class="token punctuation">(</span><span class="token punctuation">)</span>
    flag <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        timestamps <span class="token operator">=</span> get_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 检查是否超过限制</span>
        <span class="token keyword">if</span> is_over_limit<span class="token punctuation">(</span>timestamps<span class="token punctuation">,</span> LIMITS<span class="token punctuation">[</span><span class="token string">"second"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> SECONDLY_TIME_FRAME<span class="token punctuation">)</span><span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>  <span class="token comment"># 等待一段时间</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> is_over_limit<span class="token punctuation">(</span>timestamps<span class="token punctuation">,</span> LIMITS<span class="token punctuation">[</span><span class="token string">"hour"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> HOURLY_TIME_FRAME<span class="token punctuation">)</span><span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 等待一段时间</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> is_over_limit<span class="token punctuation">(</span>timestamps<span class="token punctuation">,</span> LIMITS<span class="token punctuation">[</span><span class="token string">"day"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> DAILY_TIME_FRAME<span class="token punctuation">)</span><span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 等待一段时间</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> is_over_limit<span class="token punctuation">(</span>timestamps<span class="token punctuation">,</span> LIMITS<span class="token punctuation">[</span><span class="token string">"week"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> WEEKLY_TIME_FRAME<span class="token punctuation">)</span><span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>  <span class="token comment"># 等待一段时间</span>
            <span class="token keyword">continue</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            non_zero_balances <span class="token operator">=</span> make_api_request<span class="token punctuation">(</span>address<span class="token punctuation">)</span>
            timestamps<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            update_counts<span class="token punctuation">(</span>timestamps<span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            logging<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
            flag <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token comment"># Output message if any non-zero balance is found</span>
        output_message <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"地址：</span><span class="token interpolation"><span class="token punctuation">&#123;</span>address<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
        output_message <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"\n私钥：</span><span class="token interpolation"><span class="token punctuation">&#123;</span>private_key_hex<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
        output_message <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"\n公钥：</span><span class="token interpolation"><span class="token punctuation">&#123;</span>public_key_compressed_hex<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>output_message<span class="token punctuation">)</span>
        <span class="token keyword">if</span> non_zero_balances<span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>output_message <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> flag<span class="token punctuation">:</span>
            private_key_hex<span class="token punctuation">,</span> public_key_compressed_hex<span class="token punctuation">,</span> address <span class="token operator">=</span> generate_key_pair<span class="token punctuation">(</span><span class="token punctuation">)</span>
        flag <span class="token operator">=</span> <span class="token boolean">True</span>

        <span class="token comment"># 等待以限制每秒的请求次数</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>  <span class="token comment"># 根据API请求的耗时调整这个值</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>小工具</tag>
        <tag>没用</tag>
        <tag>区块链</tag>
        <tag>blockchain</tag>
      </tags>
  </entry>
  <entry>
    <title>安卓手机玩SillyTavern（酒馆）</title>
    <url>/posts/9c94fc7b.html</url>
    <content><![CDATA[<p>最近接触了SillyTavern，也就是常说的酒馆。这玩意用的AI模型一般都不是本地部署，所以还挺适合手机玩。于是我在网上找了找教程，自己搞了搞，发现还挺简单，于是写一下。</p>
<h2 id="安装Termux">安装Termux</h2>
<p>Termux是一个Linux的终端仿真软件，可以理解为运行了一个Linux系统。<br>
可以在Github上获取。<a href="https://github.com/termux/termux-app/releases">https://github.com/termux/termux-app/releases</a><br>
下载对应你的安卓架构的安装包即可，一般来讲比较新的手机系统就直接下载<code>Android 7+</code>里的<code>arm64-v8a</code>版本即可。</p>
<h2 id="安装环境">安装环境</h2>
<div class="note info flat"><p>可能需要魔法。</p>
</div>
<p>打开你装好的Termux，先用<code>apt update</code>和<code>apt upgrade</code>更新一下包，如果中途问<code>Y/N</code>，一律都<code>Y</code>。<br>
接下来是Git和Node.js。输入<code>pkg install git</code>和<code>pkg install nodejs</code>。<br>
然后克隆SillyTavern的库。输入<code>git clone https://github.com/SillyTavern/SillyTavern.git</code>。<br>
进入SillyTavern目录，安装依赖。输入<code>cd SillyTavern</code>和<code>npm install</code>。</p>
<h2 id="开始愉快玩耍">开始愉快玩耍</h2>
<p>输入<code>./start.sh</code>即可运行SillyTavern，接下来按理说会自动跳转到浏览器，如果没跳转，就手动去访问<code>127.0.0.1:8000</code>吧。<br>
如果你重新开启Termux，需要先<code>cd SillyTavern</code>一下。</p>
<h2 id="关于另一种玩法">关于另一种玩法</h2>
<p>有一个很简单的手机玩酒馆的办法，就是用电脑运行，然后手机访问。<br>
首先更改<code>config.yaml</code>，首先<code>listen: true</code>，然后在<code>whitelist</code>中添加<code>192.168.*.*</code>（这个不用细讲应该也知道怎么添加，某些情况可能要填不一样的）。<br>
手机上一般直接用局域网内电脑的IP地址就行，端口应该默认8000。</p>
]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>娱乐</tag>
      </tags>
  </entry>
  <entry>
    <title>通过对比清理图片</title>
    <url>/posts/cbb6721e.html</url>
    <content><![CDATA[<p>因为本人平时喜好存一些图片，但经常批量下载，存了又不怎么看，因此有很多图片实际上并不需要，因此我想到了这个办法。</p>
<p>使用这个工具，输入路径后，会自动随机抽取路径下的两张图片，然后可以自己选择留下哪一张，或者是直接跳过。</p>
<p>同时，我还使用了HTTP服务，因此可以躺床上用手机操作。</p>
<p>开始运行后访问localhost:1145即可。</p>
<p>代码如下。</p>
<span id="more"></span>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> random
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span><span class="token builtin">input</span> <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pywebio<span class="token punctuation">.</span>output <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pywebio <span class="token keyword">import</span> start_server


<span class="token comment"># 1. 读取目录内的随机两张图片</span>
<span class="token keyword">def</span> <span class="token function">get_random_images</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    images <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>directory<span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">".png"</span><span class="token punctuation">,</span> <span class="token string">".jpg"</span><span class="token punctuation">,</span> <span class="token string">".jpeg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    selected_images <span class="token operator">=</span> random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>images<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>directory<span class="token punctuation">,</span> img<span class="token punctuation">)</span> <span class="token keyword">for</span> img <span class="token keyword">in</span> selected_images<span class="token punctuation">]</span>


<span class="token comment"># 2. 显示图片并处理用户选择</span>
<span class="token keyword">def</span> <span class="token function">show_images</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        image_paths <span class="token operator">=</span> get_random_images<span class="token punctuation">(</span>directory<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> image_paths<span class="token punctuation">:</span>
            put_text<span class="token punctuation">(</span><span class="token string">"目录中没有足够的图片"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>

        <span class="token comment"># 显示图片</span>
        img1 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>image_paths<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        img2 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>image_paths<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        put_row<span class="token punctuation">(</span>
            <span class="token punctuation">[</span>
                put_image<span class="token punctuation">(</span>img1<span class="token punctuation">)</span><span class="token punctuation">,</span>
                put_image<span class="token punctuation">(</span>img2<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>

        <span class="token comment"># 创建按钮</span>
        choice <span class="token operator">=</span> actions<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"留下左边"</span><span class="token punctuation">,</span> <span class="token string">"留下右边"</span><span class="token punctuation">,</span> <span class="token string">"跳过"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># 刷新页面</span>
        clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 处理用户选择</span>
        <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">"留下左边"</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>image_paths<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> choice <span class="token operator">==</span> <span class="token string">"留下右边"</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>image_paths<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> choice <span class="token operator">==</span> <span class="token string">"跳过"</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>


<span class="token comment"># 3. 开启HTTP服务</span>
<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    directory <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入图片目录的路径："</span><span class="token punctuation">)</span>
    show_images<span class="token punctuation">(</span>directory<span class="token punctuation">)</span>


start_server<span class="token punctuation">(</span>main<span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">1145</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>小工具</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】虽然我是注定没落的贵族，闲来无事只好来深究魔法</title>
    <url>/posts/25372de7.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.04.10）：3.7/10</p>
<p>个人评分：3/10</p>
<p>无聊至极，看了9集弃了。</p>
<p>属于是做成吐槽视频都没人看的类型，内容啥都没有，一看，哦声优不错。</p>
<p>我现在都想不出来剧情到底讲了什么，看了就忘了，感觉少看一集都不影响。</p>
<p>总之别看，浪费时间。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>厕纸</tag>
        <tag>后宫</tag>
      </tags>
  </entry>
  <entry>
    <title>【随便漫谈】缘结甘神家</title>
    <url>/posts/67dc5152.html</url>
    <content><![CDATA[<p>Bangumi评分（截至2025.04.17）：5.9/10</p>
<p>个人评分：8/10</p>
<p>剧情稍显老套，节奏很慢。但是人物性格刻画不错，画得也不错。</p>
<p>虽说看得我很难受（指联想到自己的人生），但我还是挺喜欢这部番的。</p>
<p>总之还是比较推荐看看，倒也没有太多特点就是了。</p>
]]></content>
      <categories>
        <category>随便漫谈</category>
      </categories>
      <tags>
        <tag>随便漫谈</tag>
        <tag>后宫</tag>
        <tag>恋爱</tag>
      </tags>
  </entry>
</search>
